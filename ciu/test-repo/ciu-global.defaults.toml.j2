# CIU test-repo global defaults

[ciu]
workspace_env_file = ".env.ciu"
require_fqdn = false
require_certs = false

[deploy]
project_name = "ciu-test"
environment_tag = "test"
network_name = "$DOCKER_NETWORK_INTERNAL"
log_level = "INFO"

[deploy.env.defaults]
TZ = "UTC"
PYTHONUNBUFFERED = "1"

[deploy.env.shared]
CONTAINER_UID = "$CONTAINER_UID"
CONTAINER_GID = "$CONTAINER_GID"
DOCKER_GID = "$DOCKER_GID"
VAULT_ADDR = "http://vault:8200"
CONSUL_ADDR = "http://consul:8500"

[deploy.groups]
infra = ["phase_1"]
apps = ["phase_2"]
all = ["phase_1", "phase_2"]

[deploy.phases.phase_1]
name = "Infra"
services = [
  { path = "infra/vault-core", name = "vault", enabled = true },
  { path = "infra/consul-core", name = "consul", enabled = true },
]

[deploy.phases.phase_2]
name = "Apps"
services = [
  { path = "applications/app-simple", name = "app-simple", enabled = true },
  { path = "applications/app-vault", name = "app-vault", enabled = true },
]
